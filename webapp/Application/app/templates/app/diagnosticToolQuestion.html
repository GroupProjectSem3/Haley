{% extends "app/mainlayout.html" %}

{% block content %}

{% load static %}
<style type="text/css">

  #spinner {
      display: none;
  }

  .loading {
    margin-top: 7px;
    border: 4px solid #f3f3f3;
  border-radius: 50%;
  border-top: 4px solid #3498db;
  width: 20px;
  height: 20px;
  -webkit-animation: spin 1s linear infinite; /* Safari */
  animation: spin 1s linear infinite;
}

/* Safari */
@-webkit-keyframes spin {
  0% { -webkit-transform: rotate(0deg); }
  100% { -webkit-transform: rotate(360deg); }
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
</style>


<div class="content-header">
  <div class="container-fluid">
    <div class="row mb-2">
      <div class="col-lg-6">
        <h1 >Diagnostic Tool</h1>
      </div><!-- /.col -->
      <!-- /.col -->
     </div>
  </div>
</div>
<!-- child content -->
    <div class="content" id="divQuestions">
      <div class="container-fluid">
        <div class="row">

            <div class="col-lg-1"></div>
         <div class="col-lg-7">

            <br>

          <form method="POST">
            {% csrf_token %}	
            
              <div class="card card-primary card-outline" > 
              <div class="card-header">
                <!-- <h5 class="m-0">How severe suffering with the symptom - ?</h5> -->
                <div class="row">
                  <div class="col-lg-7" style="font-family: inherit; font-weight: 500; font-size: 1.25rem;">
                How do you rate the severity of this symptom -
              </div>
              <div class="col-lg-4">
                <label id="lblFirst" style="font-family: inherit;font-size: 1.2rem;font-weight: bold;">{{ question }}</label>
                
                <label id="lblSymp" style="font-family: inherit;font-size: 1.2rem;font-weight: bold;"></label>
               </label></div>
              <div class="col-lg-1"><label id="spinner" class="loading" ></label></div>
              </div>
              </div>
            
                <!-- <div class="card-body" style="font-family: system-ui;color: royalblue;">
                  <input type="radio" value="0" name="wt" id="wtt"> 0 - None<br>
                  <input type="radio" value="1" name="wt" id="wtt"> 1 - Very Low<br>
                  <input type="radio" value="2" name="wt" id="wtt"> 2 - Low<br>
                  <input type="radio" value="3" name="wt" id="wtt"> 3 - Medium<br>
                  <input type="radio" value="4" name="wt" id="wtt"> 4 - High<br>
                  <input type="radio" value="5" name="wt" id="wtt"> 5 - Severe<br>
                </div> -->
                <p style="text-align: left;padding-right: 10px;color:darkorange;font-family: 'Font Awesome 5 Free';">(* Select on one of the Smiley Icon)</p>
                <br>
                 <div class="row">
                  <div class="col-lg-2"> 
                    <button type="button" name="btnwt" id="btnwt" value="0"  style="font-size:50px;border:none;background-color:white;padding-left: 10px;" >&#128578;</button>
                    <br> <label style="padding-left: 35px;font-family: sans-serif;font-size: x-large;">0</label>
                    <br> <label class="text-center" style="padding-left: 18px;padding-right: 18px;font-family: sans-serif;">No Hurt</label>
                  </div>
                  <div class="col-lg-2"> 
                    <button type="button" name="btnwt" id="btnwt"  value="1"  style="font-size:50px;border:none;background-color:white;">&#128530;</button>
                    <br> <label style="padding-left: 35px;font-family: sans-serif;font-size: x-large;">1</label>
                    <br> <label class="text-center" style="padding-left: 6px;padding-right: 6px;">Hurts Little Bit</label>
                  </div>
                  <div class="col-lg-2"> 
                    <button type="button" name="btnwt" id="btnwt"  value="2" style="font-size:50px;border:none;background-color:white;" >&#128533;</button>
                    <br> <label style="padding-left: 35px;font-family: sans-serif;font-size: x-large;">2</label>
                    <br> <label class="text-center" style="padding-left: 6px;padding-right: 6px;">Hurts Little More</label>
                  </div>
                  <div class="col-lg-2"> 
                    <button type="button" name="btnwt" id="btnwt"  value="3"  style="font-size:50px;border:none;background-color:white;" >&#128543;</button>
                    <br> <label style="padding-left: 35px;font-family: sans-serif;font-size: x-large;">3</label>
                    <br> <label class="text-center" style="padding-left: 7px;padding-right: 7px;">Hurts Even More</label>
                  </div>
                  <div class="col-lg-2"> 
                    <button type="button" name="btnwt" id="btnwt"  value="4"  style="font-size:50px;border:none;background-color:white;" >&#128534;</button>
                    <br> <label style="padding-left: 35px;font-family: sans-serif;font-size: x-large;">4</label>
                    <br> <label class="text-center" style="padding-left: 6px;padding-right: 6px;">Hurts Whole Lot</label>
                  </div>
                  <div class="col-lg-2"> 
                    <button type="button" name="btnwt" id="btnwt"  value="5" style="font-size:50px;border:none;background-color:white;" >&#128557;</button>
                    <br> <label style="padding-left: 35px;font-family: sans-serif;font-size: x-large;">5</label>
                    <br> <label class="text-center" style="padding-left: 6px;padding-right: 6px;">Hurts Worst</label>
                  </div>
                </div>
                <label id="lblBtnValue" style="visibility: hidden; height: 20px;"></label>

                <!-- <br>   -->
                <!-- <div class="row">
                <div class="col-lg-10"></div>
                <button type="button" id="btnTest" value="testing" name="btnTest" class="btn btn-rounded btn-outline-primary btn-sm" style="padding-right: 2.3rem;text-align: center;padding-left: 1.8rem;"> Next  </button>
              </div> -->
            </div>

            <!-- <div class="card-header">
              <button type="button" id="btnTest" value="testing" name="btnTest"> Next >> </button>
            </div> -->
          </form>
         
            </div>
        
            <div class="col-lg-4">
              <br>
              <div class="card card-cyan card-outline" >
              
                <div class="card-header " >
                   
                  <!-- <h3 class="card-title" style="font-family: cursive;"><i class="fas fa-info-circle"></i> {{ question }}</h3> -->
                  <i class="fas fa-info-circle"></i> <label id="lblCardName" style="font-family: inherit;font-size: 1.2rem;font-weight: bold;"> {{ question }} </label> &nbsp;
                  <label id="lblNewCardName" style="font-family: inherit;font-size: 1.2rem;font-weight: bold;"></label>  
                  <div class="card-tools">
                    <button type="button" class="btn btn-tool" data-card-widget="collapse"><i class="fas fa-minus" style="color:aliceblue;"></i>
                    </button>
                  </div>
                  <!-- /.card-tools -->
                </div>
              
                <!-- /.card-header -->
                <div class="card-body" style="display: block;">
                  <!-- The body of the card The body of the card The body of the card The body of the card The body of the card -->
                  <label id="lblCardDesc" style="font-family: inherit; font-weight: 500;"> {{ symptomDescription}} </label>
                  <label id="lblNewCardDesc" style="font-family: inherit; font-weight: 500;"></label>  
                </div>
                <!-- /.card-body -->
              </div>
              <!-- /.card -->
            </div>  
              <div class="col-lg-1"></div>


        </div>
      </div><!-- /.container-fluid -->
    </div>

    <!-- For results start-->
    <form method="POST">
    <div class="content" id="divResults" style="display: none;">
        <section class="content">
          <!-- Default box -->
          <!-- <br> -->
          <div class="container-fluid">
            <div class="row ">
              <div class="col-lg-12">
          <div class="card card-outline card-primary">
            <div class="card-header">
              <h3 class="card-title" style="font-family: inherit;font-weight: bold;">Predictions</h3>
    
              <div class="card-tools">
                <button type="button" class="btn btn-tool" data-card-widget="collapse" data-toggle="tooltip" title="Collapse">
                  <i class="fas fa-minus"></i></button>
              </div>
            </div>
            <div class="card-body">
              <div class="row">
                <div class="col-12 col-md-12 col-lg-8 order-2 order-md-1">
                  <div class="row">
                    <div class="col-12">
                      <h5> <i class="fas fa-info-circle"></i> Hi {{fname}}, based on the responses you provided here is Haley's prediction.</h5>
                      <label id="lblDiseaseName" style="color: limegreen;font-family:inherit;font-size:x-large"></label>
                      <!-- <h4 id="disease1">Disease Name: </h4> -->
                        <div class="post">
                          <div class="expandableCollapsibleDiv3">
                            <img src="../../static/dist/img/DownArrow.png" style="float: left;width:30px;padding-right: 10px;height: 22px;"/>
                              <h5>Description</h5>
                          <p id="pDesc" style="font-family: inherit; font-weight: 500; padding-left: 45px;"></p>
                          <p style="text-align: center;">
                            <a href="http://www.default.com/" target="_blank" class="link-black text-sm" style="color: #007bff; font-size: 17px;"><i class="fas fa-link mr-1"></i> Tell me more</a>
                          </p>
                        </div>
                      </div>
    
                        <div class="post clearfix">
                          <div class="expandableCollapsibleDiv">
                          <!-- <div class="user-block"> -->
                            <!-- <img class="img-circle img-bordered-sm" src="../../dist/img/user7-128x128.jpg" alt="User Image"> -->
                              <img src="../../static/dist/img/DownArrow.png" style="float: left;width:30px;padding-right: 10px;height: 22px;"/>
                              <h5>Possible Causes</h5>
                          <!-- </div> -->
                          <!-- /.user-block -->
                          <p id="pCauses" style="font-family: inherit; font-weight: 500; padding-left: 45px;"></p>
                        </div>
                          <!-- <p>
                            <a href="#" class="link-black text-sm"><i class="fas fa-link mr-1"></i> Demo File 2</a>
                          </p> -->
                        </div>
    
                        <div class="post">
                          <div class="expandableCollapsibleDiv2">
                            <!-- <img class="img-circle img-bordered-sm" src="../../dist/img/user1-128x128.jpg" alt="user image"> -->
                            <img src="../../static/dist/img/DownArrow.png" style="float: left;width:30px;padding-right: 10px;height: 22px;"/>  
                            <h5>Symptoms</h5>
                          <!-- /.user-block -->
                          <div class="user-block" style="font-family: inherit; font-weight: 500;">
                              <!-- <span class="username"> -->
                              <ul id="ulSymptoms"> 
                                  <!-- <li>Present
                                     <ul id="liPresent">
                                        <li>Fatigue </li> 
                                        <li>Fever</li> 
                                     </ul>
                                  </li>
                                  <li>Absent
                                     <ul id="liAbsent">
                                         <li>Fatigue </li>
                                         <li>Fever</li> 
                                     </ul>
                                  </li> -->
                               </ul>
                              <!-- </span> -->
                            </div>
                          </div>
                        </div>
                    </div>
                  </div>
                </div>
                <div class="col-12 col-md-12 col-lg-4 order-1 order-md-2">
  
                  <!-- <h3 class="text-primary"><i class="fas fa-paint-brush"></i> AdminLTE v3</h3>  -->
                  <div style="text-align: center;">
                   <button type="button" class="btn btn-info btn-lg" onclick="location.href='{% url 'GPList' %}'"> Find GP's nearby
                    <i class="nav-icon fas fa-user-md"></i>
                    </button>
                  </div>  
                  <br>
                  <div class="card-body">
                      <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
                        <ol class="carousel-indicators">
                          <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
                          <!-- <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
                          <li data-target="#carouselExampleIndicators" data-slide-to="2"></li> -->
                        </ol>
                        <div class="carousel-inner">
                          <div class="carousel-item active">
                              <!-- <img class="d-block w-100" src="https://www.internationalglobalhealth.com/upload/Dengue-Fever-banner.jpg" alt="First slide"> -->
                              <img id="diseaseImage" class="d-block w-100" src="" alt="First slide">
                          </div>
                          <!-- <div class="carousel-item">
                            <img class="d-block w-100" src="https://placehold.it/900x500/3c8dbc/ffffff&text=I+Love+Bootstrap" alt="Second slide">
                          </div>
                          <div class="carousel-item">
                            <img class="d-block w-100" src="https://placehold.it/900x500/f39c12/ffffff&text=I+Love+Bootstrap" alt="Third slide">
                          </div> -->
                        </div>
                        <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
                          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                          <span class="sr-only">Previous</span>
                        </a>
                        <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
                          <span class="carousel-control-next-icon" aria-hidden="true"></span>
                          <span class="sr-only">Next</span>
                        </a>
                      </div>
                    </div>
                  <!-- <div class="text-center mt-5 mb-3">
                      <button type="button" class="btn btn-outline-info" onclick="location.href='{% url 'diagnosticTool' %}'" >Start Diagnosis
                          <i class="nav-icon fas fa-tachometer-alt"></i>
                        </button>
                    <a href="#" class="btn btn-sm btn-warning">Report contact</a> -->
                  <!-- </div>  -->
                </div>
              </div>
            </div>
            <!-- /.card-body -->
          </div>
        </div>
          <!-- /.card -->
    </div>
          </div>
        </section>
      <!-- /.content -->
    
      </div>
    </form>
    
<!-- For results end-->

{% endblock %} 

{% block javascript %}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
<script>
//   $(document).ready(function () {
//  var executed = false;
// var loaded = function spinner () {
//     if (!executed) {
//         $("#spinner").fadeOut("slow");
//         setTimeout(function () {
//             $('body').addClass('loaded');
//         }, 10);
//         executed = true;
//     }
// };
// $(window).on('load', loaded);
// setTimeout(loaded, 1000);
// });

  $(document).ready(function () {

    var defaultElementDescription = $(".expandableCollapsibleDiv").find("p");
    defaultElementDescription.hide("fast", "swing");
    var defaultElementDescription2 = $(".expandableCollapsibleDiv2").find("div");
    defaultElementDescription2.hide("fast", "swing");
    var defaultElementDescription3 = $(".expandableCollapsibleDiv3").find("p");
    defaultElementDescription3.hide("fast", "swing");

    $(".expandableCollapsibleDiv > img").click(function (e) {
      var showElementDescription = 
        $(this).parents(".expandableCollapsibleDiv").find("p");
  
      if ($(showElementDescription).is(":visible")) {
        showElementDescription.hide("fast", "swing");
        $(this).attr("src", "../../static/dist/img/DownArrow.png");
      } else {
        showElementDescription.show("fast", "swing");
        $(this).attr("src", "../../static/dist/img/UpArrow.png");
      }
    });
    $(".expandableCollapsibleDiv2 > img").click(function (e) {
      var showElementDescription = 
        $(this).parents(".expandableCollapsibleDiv2").find("div");
  
      if ($(showElementDescription).is(":visible")) {
        showElementDescription.hide("fast", "swing");
        $(this).attr("src", "../../static/dist/img/DownArrow.png");
      } else {
        showElementDescription.show("fast", "swing");
        $(this).attr("src", "../../static/dist/img/UpArrow.png");
      }
    });
    $(".expandableCollapsibleDiv3 > img").click(function (e) {
      var showElementDescription = 
        $(this).parents(".expandableCollapsibleDiv3").find("p");
  
      if ($(showElementDescription).is(":visible")) {
        showElementDescription.hide("fast", "swing");
        $(this).attr("src", "../../static/dist/img/DownArrow.png");
      } else {
        showElementDescription.show("fast", "swing");
        $(this).attr("src", "../../static/dist/img/UpArrow.png");
      }
    });
  });


  $(jQuery).on('click', "#btnwt", function() {
    $("#lblBtnValue").html($(this).val());
    
    // if ($('input[name="wt"]:checked').length == 0) {
    //      alert('please select one severity..');
    //      return false; } 
    if($("#lblBtnValue").html() == ""){
         alert('please select one severity..');
         return false; } 
    var symptom = '';
    if($("#lblFirst").is(":visible"))
    {
      symptom = $("#lblFirst").html();
    }
    else
    {
      symptom = $("#lblSymp").html();
    }
    $(this).blur();
    //
    var myDiv = document.getElementById("spinner")
    myDiv.style.display = "block";
    //
      $.ajax({
        url: '/ajax/symptom_nextClick/',
        data: {
          //'wt': $("input[name='wt']:radio:checked").val(),
          'wt': $("#lblBtnValue").html(),
          // 'symp' : $("#lblSymp").val(),
          'symp' : symptom,
        },
        dataType: 'json',
        success: function (data) {
          $("#lblBtnValue").html("")
          if (data.is_taken) {
            $("#lblSymp").html(data.nextSymptom)
            //$("input[name='wt']:radio:checked").prop('checked',false);
            $("#lblFirst").hide();
            $("#lblNewCardName").html(data.nextSymptom)
            $("#lblCardName").hide();
            $("#lblNewCardDesc").html(data.symptomDescription)
            $("#lblCardDesc").hide();
            $("#divResults").hide();
          }
          else{
            $("#divResults").show();
            $("#divQuestions").hide();
            $("#lblDiseaseName").html(data.forDiseases);
            $("#pDesc").html(data.forDesc);
            $("#pCauses").html(data.forCauses);
            $("a[href='http://www.default.com/']").attr('href', data.forLink);
            $("#diseaseImage").attr("src", "../../static/dist/img/disease/"+data.forDiseases+".jpg");

            var list_html1 = "";
            //var list_html2 = "";
                if(data.forSympPresent.length>0)
                {
                  list_html1 += "<li>Present <ul>";
                  for(var i=0;i<data.forSympPresent.length;i++)
                  {
                      list_html1 +="<li>" + data.forSympPresent[i] +"</li>";
                  }  
                  list_html1 += "</ul> </li>";
                }
                //$("#liPresent").html(list_html1);
                if(data.forSympAbsent.length>0)
                {
                  list_html1 += "<li>Absent<ul>";
                  for(var i=0;i<data.forSympAbsent.length;i++)
                  {
                      list_html1 +="<li>" + data.forSympAbsent[i] +"</li>";
                  }
                  list_html1 += "</ul> </li>";
                }
                //$("#liAbsent").html(list_html2);
                $("#ulSymptoms").html(list_html1);

          }
          myDiv.style.display = "none";
        }
      });

});

  $("#btnTest").click(function () {
    // // if ($('input[name="wt"]:checked').length == 0) {
    // //      alert('please select one severity..');
    // //      return false; } 
    // if($("#lblBtnValue").html() == ""){
    //      alert('please select one severity..');
    //      return false; } 
    // var symptom = '';
    // if($("#lblFirst").is(":visible"))
    // {
    //   symptom = $("#lblFirst").html();
    // }
    // else
    // {
    //   symptom = $("#lblSymp").html();
    // }
    //   $.ajax({
    //     url: '/ajax/symptom_nextClick/',
    //     data: {
    //       //'wt': $("input[name='wt']:radio:checked").val(),
    //       'wt': $("#lblBtnValue").html(),
    //       // 'symp' : $("#lblSymp").val(),
    //       'symp' : symptom,
    //     },
    //     dataType: 'json',
    //     success: function (data) {
    //       $("#lblBtnValue").html("")
    //       if (data.is_taken) {
    //         $("#lblSymp").html(data.nextSymptom)
    //         //$("input[name='wt']:radio:checked").prop('checked',false);
    //         $("#lblFirst").hide();
    //         $("#lblNewCardName").html(data.nextSymptom)
    //         $("#lblCardName").hide();
    //         $("#lblNewCardDesc").html(data.symptomDescription)
    //         $("#lblCardDesc").hide();
    //         $("#divResults").hide();
    //       }
    //       else{
    //         $("#divResults").show();
    //         $("#divQuestions").hide();
    //         $("#lblDiseaseName").html(data.forDiseases);
    //         $("#pDesc").html(data.forDesc);
    //         $("#pCauses").html(data.forCauses);
    //         $("a[href='http://www.default.com/']").attr('href', data.forLink);
    //         $("#diseaseImage").attr("src", "../../static/dist/img/disease/"+data.forDiseases+".jpg");

    //         var list_html1 = "";
    //         //var list_html2 = "";
    //             if(data.forSympPresent.length>0)
    //             {
    //               list_html1 += "<li>Present <ul>";
    //               for(var i=0;i<data.forSympPresent.length;i++)
    //               {
    //                   list_html1 +="<li>" + data.forSympPresent[i] +"</li>";
    //               }  
    //               list_html1 += "</ul> </li>";
    //             }
    //             //$("#liPresent").html(list_html1);
    //             if(data.forSympAbsent.length>0)
    //             {
    //               list_html1 += "<li>Present <ul>";
    //               for(var i=0;i<data.forSympAbsent.length;i++)
    //               {
    //                   list_html1 +="<li>" + data.forSympAbsent[i] +"</li>";
    //               }
    //               list_html1 += "</ul> </li>";
    //             }
    //             //$("#liAbsent").html(list_html2);
    //             $("#ulSymptoms").html(list_html1);

    //       }
    //     }
    //   });

    });

// **** Script For Results
$(function () {
    //-------------
    //- DONUT CHART -
    //-------------
    // Get context with jQuery - using jQuery's .get() method.
    // var donutChartCanvas = $('#donutChart').get(0).getContext('2d')
    // //alert($('#donutChart').get(0))
    // //var donutChartCanvas =  document.querySelector("#donutChart");
    // var donutData        = {
    //   labels: [
    //       'Disease A', 
    //       'Disease B',
    //       'Disease C', 
    //       // 'Safari', 
    //       // 'Opera', 
    //       // 'Navigator', 
    //   ],
    //   datasets: [
    //     {
    //      // data: [700,500,400,600,300,100],
    //      // backgroundColor : ['#f56954', '#00a65a', '#f39c12', '#00c0ef', '#3c8dbc', '#d2d6de'],
    //      data: [30,20,50],
    //      backgroundColor : ['#f56954', '#00a65a', '#f39c12'],
    //     }
    //   ]
    // }
    // var donutOptions     = {
    //   maintainAspectRatio : false,
    //   responsive : true,
    // }
    // //Create pie or douhnut chart
    // // You can switch between pie and douhnut using the method below.
    // var donutChart = new Chart(donutChartCanvas, {
    //   type: 'doughnut',
    //   data: donutData,
    //   options: donutOptions      
    // })
  })

  function spinner() {
    // var myDiv = document.getElementById("spinner")
    // show = function  spinner(){
    //     myDiv.style.display = "block";
    //     setTimeout(hide, 1000); // 0.5 seconds
    //   },
    //   hide = function  spinner(){
    //   myDiv.style.display = "none";
    //    };
    //    show();
      };
    

  //   function spinner(){
  //   var myDiv = document.getElementById("spinner"),

  //     show = function  spinner(){
  //       myDiv.style.display = "block";
  //       setTimeout(hide, 1000); // 5 seconds
  //     },

  //     hide = function  spinner(){
  //       myDiv.style.display = "none";
  //     };

  //   show();
  // })();
   
</script>
{% endblock %}

